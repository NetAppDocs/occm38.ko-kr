---
sidebar: sidebar 
permalink: task_replicating_data.html 
keywords: ontap, cluster, discover, manage, cloud manager, hybrid cloud, replication policy, policy, replication, replicating, snapmirror, snapvault, data replication, fanout, cascade, source, destination, schedule, relationship, break, resync, max transfer, maximum transfer rate, rate, transfer rate, reverse resync, status, replication status, intercluster lif, replication requirement, requirements, disaster recovery, DR, archive, archiving, retention 
summary: Cloud Manager 작업 환경 간에 데이터를 복제할 수 있습니다. 1회 데이터 복제를 선택하여 데이터를 클라우드 간에 이동하거나, 재해 복구 또는 장기 보존을 위한 반복 일정을 선택할 수 있습니다. 
---
= 시스템 간 데이터 복제
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
데이터 전송을 위한 일회성 데이터 복제 또는 재해 복구 또는 장기 보존을 위한 반복 일정을 선택하여 작업 환경 간에 데이터를 복제할 수 있습니다. 예를 들어, 재해 복구를 위해 사내 ONTAP 시스템에서 Cloud Volumes ONTAP로 데이터 복제를 설정할 수 있습니다.

Cloud Manager는 SnapMirror 및 SnapVault 기술을 사용하여 개별 시스템의 볼륨 간 데이터 복제를 단순화합니다. 소스 볼륨과 타겟 볼륨을 확인한 다음 복제 정책 및 일정을 선택하기만 하면 됩니다. Cloud Manager는 필요한 디스크를 구매하고 관계를 구성하고 복제 정책을 적용한 다음 볼륨 간 기본 전송을 시작합니다.


NOTE: 기본 전송에는 소스 데이터의 전체 복사본이 포함됩니다. 후속 전송에는 소스 데이터의 차등 복제본이 포함됩니다.

Cloud Manager를 사용하면 다음과 같은 유형의 작업 환경 간에 데이터를 복제할 수 있습니다.

* Cloud Volumes ONTAP 시스템에서 다른 Cloud Volumes ONTAP 시스템으로
* Cloud Volumes ONTAP 시스템과 온프레미스 ONTAP 클러스터 간에 사용할 수 있습니다
* 사내 ONTAP 클러스터에서 다른 온프레미스 ONTAP 클러스터로




== 데이터 복제 요구 사항

데이터를 복제하기 전에 Cloud Volumes ONTAP 시스템과 ONTAP 클러스터 모두에 대한 특정 요구사항이 충족되는지 확인해야 합니다.

버전 요구 사항:: 데이터를 복제하기 전에 소스 볼륨과 타겟 볼륨에서 호환되는 ONTAP 버전이 실행되고 있는지 확인해야 합니다. 자세한 내용은 를 참조하십시오 http://docs.netapp.com/ontap-9/topic/com.netapp.doc.pow-dap/home.html["데이터 보호 전원 가이드"^].
Cloud Volumes ONTAP 관련 요구사항::
+
--
* 인스턴스의 보안 그룹에는 필요한 인바운드 및 아웃바운드 규칙, 특히 ICMP 및 포트 11104 및 11105에 대한 규칙이 포함되어야 합니다.
+
이러한 규칙은 미리 정의된 보안 그룹에 포함되어 있습니다.

* 서로 다른 서브넷에 있는 두 Cloud Volumes ONTAP 시스템 간에 데이터를 복제하려면 서브넷을 함께 라우팅해야 합니다(기본 설정).
* AWS의 Cloud Volumes ONTAP 시스템과 Azure의 시스템 간에 데이터를 복제하려면 AWS VPC와 Azure VNET 간에 VPN 연결이 있어야 합니다.


--
ONTAP 클러스터별 요구사항::
+
--
* 활성 SnapMirror 라이센스가 설치되어 있어야 합니다.
* 클러스터가 사내에 있는 경우 회사 네트워크에서 일반적으로 VPN 연결인 AWS 또는 Azure로 연결되어 있어야 합니다.
* ONTAP 클러스터는 추가 서브넷, 포트, 방화벽 및 클러스터 요구사항을 충족해야 합니다.
+
자세한 내용은 사용 중인 ONTAP 버전에 대한 클러스터 및 SVM 피어링 익스프레스 가이드를 참조하십시오.



--




== 시스템 간 데이터 복제 설정

1회 데이터 복제를 선택하여 Cloud Volumes ONTAP 시스템과 ONTAP 클러스터 간에 데이터를 복제할 수 있습니다. 이 경우 클라우드 간에 데이터를 이동하거나, 재해 복구 또는 장기 보존에 도움이 되는 반복 일정을 선택할 수 있습니다.

.이 작업에 대해
Cloud Manager는 단순, 팬아웃 및 계단식 데이터 보호 구성을 지원합니다.

* 간단한 구성에서는 볼륨 A에서 볼륨 B로 복제가 수행됩니다
* 팬아웃 구성에서는 볼륨 A에서 여러 대상으로 복제가 수행됩니다.
* 다중 구간 구성에서는 볼륨 A에서 볼륨 B로, 볼륨 B에서 볼륨 C로 복제가 수행됩니다


시스템 간에 여러 데이터 복제를 설정하여 Cloud Manager에서 팬아웃 및 캐스케이드 구성을 구성할 수 있습니다. 예를 들어, 시스템 A에서 시스템 B로 볼륨을 복제한 다음 시스템 B에서 시스템 C로 동일한 볼륨을 복제합니다

.단계
. 작업 환경 페이지에서 소스 볼륨이 포함된 작업 환경을 선택한 다음 볼륨을 복제할 작업 환경으로 끌어다 놓습니다.
+
image:screenshot_drag_and_drop.gif["스크린샷: 데이터 복제 프로세스를 시작하기 위해 다른 작업 환경 위에 작업 환경을 배치하는 것을 보여 줍니다."]

. 소스 및 대상 피어링 설정 페이지가 나타나면 클러스터 피어 관계에 대한 인터클러스터 LIF를 모두 선택합니다.
+
클러스터 피어가 _pair-wise full-mesh 연결_을 가지도록 인터클러스터 네트워크를 구성해야 합니다. 즉, 클러스터 피어 관계의 각 클러스터 쌍이 모든 인터클러스터 LIF 간에 연결을 가지도록 해야 합니다.

+
이러한 페이지는 여러 LIF가 있는 ONTAP 클러스터가 소스 또는 대상인 경우 나타납니다.

. 소스 볼륨 선택 페이지에서 복제할 볼륨을 선택합니다.
. 대상 볼륨 이름 및 계층화 페이지에서 대상 볼륨 이름을 지정하고, 기본 디스크 유형을 선택하고, 고급 옵션을 변경한 다음 * 계속 * 을 클릭합니다.
+
대상이 ONTAP 클러스터인 경우 대상 SVM 및 애그리게이트를 지정해야 합니다.

. 최대 전송 속도 페이지에서 데이터를 전송할 수 있는 최대 속도(초당 메가바이트)를 지정합니다.
. 복제 정책 페이지에서 기본 정책 중 하나를 선택하거나 * 추가 정책 * 을 클릭한 다음 고급 정책 중 하나를 선택합니다.
+
자세한 내용은 을 참조하십시오 link:task_replicating_data.html#choosing-a-replication-policy["복제 정책을 선택합니다"].

+
사용자 지정 백업(SnapVault) 정책을 선택한 경우 정책과 연결된 레이블이 소스 볼륨의 스냅샷 복사본 레이블과 일치해야 합니다. 자세한 내용은 을 참조하십시오 link:task_replicating_data.html#how-backup-policies-work["백업 정책의 작동 방식"].

. 일정 페이지에서 1회 복사본 또는 반복 일정을 선택합니다.
+
몇 가지 기본 스케줄을 사용할 수 있습니다. 다른 스케줄을 지정하려면 System Manager를 사용하여 _destination_cluster에 새 스케줄을 생성해야 합니다.

. 검토 페이지에서 선택 항목을 검토한 다음 * Go * 를 클릭합니다.


.결과
Cloud Manager가 데이터 복제 프로세스를 시작합니다. 복제 상태 페이지에서 복제에 대한 세부 정보를 볼 수 있습니다.



== 데이터 복제 일정 및 관계 관리

두 시스템 간에 데이터 복제를 설정한 후에는 Cloud Manager에서 데이터 복제 일정과 관계를 관리할 수 있습니다.

.단계
. 작업 환경 페이지에서 작업 영역 또는 특정 작업 환경의 모든 작업 환경에 대한 복제 상태를 확인합니다.
+
[cols="15,85"]
|===
| 옵션을 선택합니다 | 조치 


| 작업 공간의 모든 작업 환경  a| 
Cloud Manager 상단에서 * Replication * 을 클릭합니다.



| 특정 작업 환경  a| 
작업 환경을 열고 * 복제 * 를 클릭합니다.

|===
. 데이터 복제 관계의 상태를 검토하여 상태가 양호한지 확인합니다.
+

NOTE: 관계의 상태가 유휴 상태이고 미러 상태가 초기화되지 않은 경우 정의된 일정에 따라 데이터 복제가 수행되도록 대상 시스템에서 관계를 초기화해야 합니다. System Manager 또는 CLI(Command-Line Interface)를 사용하여 관계를 초기화할 수 있습니다. 이러한 상태는 대상 시스템에 장애가 발생한 후 다시 온라인 상태가 될 때 나타날 수 있습니다.

. 소스 볼륨 옆의 메뉴 아이콘을 선택한 다음 사용 가능한 작업 중 하나를 선택합니다.
+
image:screenshot_replication_managing.gif["스크린샷: 복제 상태 페이지에서 사용할 수 있는 작업 목록을 표시합니다."]

+
다음 표에는 사용 가능한 작업이 설명되어 있습니다.

+
[cols="15,85"]
|===
| 조치 | 설명 


| 휴식 | 소스 볼륨과 타겟 볼륨 간의 관계를 끊은 후 데이터 액세스를 위해 타겟 볼륨을 활성화합니다. 이 옵션은 일반적으로 소스 볼륨에서 데이터 손상, 실수로 인한 삭제 또는 오프라인 상태와 같은 이벤트로 인해 데이터를 제공할 수 없는 경우에 사용됩니다. 데이터 액세스를 위한 대상 볼륨을 구성하고 소스 볼륨을 재활성화하는 방법에 대한 자세한 내용은 ONTAP 9 볼륨 재해 복구 익스프레스 가이드를 참조하십시오. 


| 재동기화  a| 
볼륨 간의 끊어진 관계를 다시 설정하고 정의된 일정에 따라 데이터 복제를 재개합니다.


IMPORTANT: 볼륨을 재동기화하면 대상 볼륨의 내용이 소스 볼륨의 컨텐츠로 덮어쓰여집니다.

대상 볼륨에서 소스 볼륨으로 데이터를 재동기화하는 역방향 재동기화를 수행하려면 을 참조하십시오 http://docs.netapp.com/ontap-9/topic/com.netapp.doc.exp-sm-ic-fr/home.html["ONTAP 9 볼륨 재해 복구 익스프레스 가이드"^].



| 재동기화 | 소스 및 대상 볼륨의 역할을 바꿉니다. 원본 소스 볼륨의 컨텐츠는 대상 볼륨의 컨텐츠로 덮어쓰여집니다. 이 기능은 오프라인 상태인 소스 볼륨을 다시 활성화하려는 경우에 유용합니다. 마지막 데이터 복제와 소스 볼륨이 비활성화된 시간 사이에 원본 소스 볼륨에 기록된 데이터는 보존되지 않습니다. 


| 일정 편집 | 데이터 복제에 다른 스케줄을 선택할 수 있습니다. 


| 정책 정보 | 에는 데이터 복제 관계에 할당된 보호 정책이 나와 있습니다. 


| 최대 전송 속도를 편집합니다 | 데이터를 전송할 수 있는 최대 속도(KB/초)를 편집할 수 있습니다. 


| 업데이트 | 대상 볼륨을 업데이트하기 위해 증분 전송을 시작합니다. 


| 삭제 | 소스 볼륨과 타겟 볼륨 간의 데이터 보호 관계를 삭제합니다. 즉, 볼륨 간에 데이터 복제가 더 이상 발생하지 않습니다. 이 작업을 수행해도 데이터 액세스를 위한 대상 볼륨은 활성화되지 않습니다. 이 작업을 수행하면 시스템 간에 다른 데이터 보호 관계가 없는 경우 클러스터 피어 관계 및 SVM(스토리지 가상 시스템) 피어 관계도 삭제됩니다. 
|===


.결과
작업을 선택하면 Cloud Manager에서 관계 또는 일정을 업데이트합니다.



== 복제 정책을 선택합니다

Cloud Manager에서 데이터 복제를 설정할 때 복제 정책을 선택하는 데 도움이 필요할 수 있습니다. 복제 정책은 스토리지 시스템이 소스 볼륨에서 대상 볼륨으로 데이터를 복제하는 방법을 정의합니다.



=== 복제 정책의 기능

ONTAP 운영 체제는 스냅샷 복사본이라는 백업을 자동으로 생성합니다. 스냅샷 복사본은 특정 시점의 파일 시스템 상태를 캡처하는 볼륨의 읽기 전용 이미지입니다.

시스템 간에 데이터를 복제할 때 소스 볼륨에서 타겟 볼륨으로 스냅샷 복사본을 복제합니다. 복제 정책은 소스 볼륨에서 타겟 볼륨으로 복제할 스냅샷 복사본을 지정합니다.


TIP: 복제 정책은 SnapMirror 및 SnapVault 기술을 기반으로 재해 복구 보호 및 D2D 백업 및 복구를 제공하기 때문에 _protection_policies라고도 합니다.

다음 이미지는 스냅샷 복사본과 복제 정책 간의 관계를 보여줍니다.

image:diagram_replication_policies.png["이 그림에서는 소스 볼륨의 스냅샷 복사본과 소스 볼륨에서 타겟 볼륨으로의 특정 스냅샷 복사본 복제를 지정하는 복제 정책을 보여 줍니다."]



=== 복제 정책의 유형입니다

다음과 같은 세 가지 유형의 복제 정책이 있습니다.

* Mirror_policy는 새로 생성된 스냅샷 복사본을 대상 볼륨에 복제합니다.
+
이러한 스냅샷 복사본을 사용하여 재해 복구 또는 1회 데이터 복제에 대비하여 소스 볼륨을 보호할 수 있습니다. 언제든지 데이터 액세스를 위해 대상 볼륨을 활성화할 수 있습니다.

* A_Backup_policy는 특정 스냅샷 복사본을 대상 볼륨에 복제하고 일반적으로 소스 볼륨에서보다 더 오랜 기간 동안 유지합니다.
+
데이터가 손상 또는 손실된 경우 이러한 스냅샷 복사본에서 데이터를 복원할 수 있으며 표준 준수 및 기타 거버넌스 관련 목적을 위해 데이터를 보존할 수 있습니다.

* A_Mirror 및 Backup_policy는 재해 복구와 장기 보존을 모두 제공합니다.
+
각 시스템에는 다양한 상황에서 사용할 수 있는 기본 미러 및 백업 정책이 포함되어 있습니다. 사용자 지정 정책이 필요한 경우 System Manager를 사용하여 직접 만들 수 있습니다.



다음 이미지는 미러 정책과 백업 정책의 차이를 보여 줍니다. 미러 정책은 소스 볼륨에서 사용할 수 있는 스냅샷 복사본을 미러링합니다.

image:diagram_replication_snapmirror.png["이 그림에서는 소스 볼륨의 스냅샷 복사본과 소스 볼륨을 미러링하는 타겟 볼륨을 보여 줍니다."]

백업 정책은 일반적으로 소스 볼륨에 유지되는 것보다 더 오래 스냅샷 복사본을 유지합니다.

image:diagram_replication_snapvault.png["이 그림에서는 SnapVault가 스냅샷 복사본을 장기간 보존하므로 소스 볼륨과 백업 타겟 볼륨의 스냅샷 복사본을 보여 줍니다."]



=== 백업 정책의 작동 방식

미러 정책과 달리 백업(SnapVault) 정책은 특정 스냅샷 복사본을 타겟 볼륨에 복제합니다. 기본 정책 대신 고유한 정책을 사용하려는 경우 백업 정책의 작동 방식을 이해하는 것이 중요합니다.



==== 스냅샷 복사본 레이블과 백업 정책 간의 관계 이해

스냅샷 정책은 시스템에서 볼륨의 스냅샷 복사본을 생성하는 방법을 정의합니다. 이 정책에서는 스냅샷 복사본을 생성할 시기, 유지할 복사본 수 및 레이블 지정 방법을 지정합니다. 예를 들어, 시스템이 매일 오전 12:10에 스냅샷 복사본 하나를 생성하고 가장 최근의 복사본 2개를 보관하며 이 복사본을 "매일"이라고 지정할 수 있습니다.

백업 정책에는 레이블이 지정된 Snapshot 복사본을 대상 볼륨에 복제할 볼륨 및 유지할 복사본 수를 지정하는 규칙이 포함되어 있습니다. 백업 정책에 정의된 레이블은 스냅샷 정책에 정의된 하나 이상의 레이블과 일치해야 합니다. 그렇지 않으면 시스템에서 스냅샷 복사본을 복제할 수 없습니다.

예를 들어 "매일" 및 "매주" 레이블이 포함된 백업 정책을 사용하면 이러한 레이블만 포함된 스냅샷 복사본이 복제됩니다. 다음 이미지와 같이 다른 스냅샷 복사본은 복제되지 않습니다.

image:diagram_replication_snapvault_policy.png["이 그림에서는 스냅샷 정책, 소스 볼륨, 스냅샷 정책을 통해 생성된 스냅샷 복사본, 백업 정책을 기반으로 타겟 볼륨에 스냅샷 복사본 복제, \"매일\" 및 \"매주\" 레이블이 있는 스냅샷 복사본의 복제를 지정합니다."]



==== 기본 정책 및 사용자 지정 정책

기본 스냅샷 정책은 매시간, 일별, 주별 스냅샷 복사본을 생성하여 6시간, 2일 및 2개의 주별 스냅샷 복사본을 유지합니다.

기본 스냅샷 정책과 함께 기본 백업 정책을 쉽게 사용할 수 있습니다. 기본 백업 정책은 매일 및 매주 스냅샷 복사본을 복제하며 매일 7개 및 매주 52개의 스냅샷 복사본을 유지합니다.

사용자 지정 정책을 만드는 경우 해당 정책에 정의된 레이블이 일치해야 합니다. System Manager를 사용하여 사용자 지정 정책을 생성할 수 있습니다.



== NetApp HCI에서 Cloud Volumes ONTAP로 데이터 복제

NetApp HCI에서 Cloud Volumes ONTAP로 데이터를 복제하려는 경우 SnapMirror를 사용하여 NetApp Element 소프트웨어를 실행하는 NetApp HCI 시스템에서 복제할 수 있습니다. 또는 NetApp HCI 솔루션에서 가상 게스트로 실행되는 ONTAP Select 시스템에서 생성된 볼륨에 대한 데이터를 Cloud Volumes ONTAP에 복제할 수도 있습니다.

자세한 내용은 다음 기술 보고서를 참조하십시오.

* https://www.netapp.com/us/media/tr-4641.pdf["기술 보고서 4641: NetApp HCI 데이터 보호"^]
* https://www.netapp.com/us/media/tr-4651.pdf["기술 보고서 4651: NetApp SolidFire SnapMirror 아키텍처 및 구성"^]

